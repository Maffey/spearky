#:kivy 1.11.1

#:import mac_changer core.penetration.mac_changer

#:set standard_padding 20
#:set standard_text_height 30
#:set standard_menu_padding 40


# Root widget of the app.
WindowManager:
    MainMenuScreen:

    DetectionToolsScreen:
    SniffPacketsScreen:

    EscalationToolsScreen:

    PenetrationToolsScreen:
    ChangeMACScreen:
    SpoofARPScreen:


<MainMenuScreen>:
    name: "main_menu_screen"

    # TODO: change how the buttons are layered out or the type of Layout.
    BoxLayout:
        orientation: "vertical"
        spacing: root.height / 6
        padding: standard_menu_padding

        Label:
            text: "Spearky"
            font_size: 48

        Button:
            text: "Detection Tools"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "detection_tools_screen"
                root.manager.transition.direction = "left"

        Button:
            text: "Escalation Tools"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5

        Button:
            text: "Penetration Tools"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "penetration_tools_screen"
                root.manager.transition.direction = "left"


<DetectionToolsScreen>:
    name: "detection_tools_screen"

    BoxLayout:
        orientation: "vertical"
        spacing: root.height / 4
        padding: standard_menu_padding

        Button:
            text: "Sniff Packets"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "sniff_packets_screen"
                root.manager.transition.direction = "left"

        Button:
            text: "Back"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "main_menu_screen"
                root.manager.transition.direction = "right"


<SniffPacketsScreen>:
    name: "sniff_packets_screen"

    BoxLayout:
        orientation: "vertical"

        Label:
            text: "Test"

        Button:
            text: "Back"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "detection_tools_screen"
                root.manager.transition.direction = "right"


<EscalationToolsScreen>:


<PenetrationToolsScreen>:
    name: "penetration_tools_screen"

    BoxLayout:
        orientation: "vertical"
        spacing: root.height / 4
        padding: standard_menu_padding

        Button:
            text: "Change MAC Address"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "change_mac_screen"
                root.manager.transition.direction = "left"

        Button:
            text: "Spoof ARP Table"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "spoof_arp_screen"
                root.manager.transition.direction = "left"

        Button:
            text: "Back"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "main_menu_screen"
                root.manager.transition.direction = "right"


<ChangeMACScreen>:
    name: "change_mac_screen"
    original_mac: original_mac_label
    current_mac: current_mac_label
    interface_input: interface_text_input
    mac_input: mac_text_input

    size: 500, 40

    # TODO: separate GridLayout and improve the overall layout
    BoxLayout:
        orientation: "vertical"

        GridLayout:
            cols: 2
            padding: standard_padding
            spacing: 8

            Label:
                text: "Original MAC address:"
                size_hint: 1, None
                height: standard_text_height
                bold: True

            Label:
                id: original_mac_label
                text: mac_changer.get_original_mac()
                size_hint: 1, None
                height: standard_text_height

            Label:
                text: "Current MAC address:"
                size_hint: 1, None
                height: standard_text_height
                bold: True

            Label:
                id: current_mac_label
                text: mac_changer.get_current_mac()
                size_hint: 1, None
                height: standard_text_height

            Label:
                text: "Interface:"
                size_hint: 1, None
                height: standard_text_height
                bold: True

            TextInput:
                id: interface_text_input
                hint_text: "eth0"
                size_hint: 1, None
                height: standard_text_height
                multiline: False

            Label:
                text: "MAC address:"
                size_hint: 1, None
                height: standard_text_height
                bold: True

            TextInput:
                id: mac_text_input
                hint_text: "00:a1:b2:c3:d4:d5:"
                size_hint: 1, None
                height: standard_text_height
                multiline: False

        FloatLayout:

            Button:
                id: submit_mac_button
                text: "Submit"
                pos_hint: {"center_x": 0.8, "y": 0.4}
                size_hint: 0.25, 0.25
                on_release: root.submit_mac()

            Button:
                id: revert_mac_changes_button
                text: "Revert"
                pos_hint: {"center_x": 0.8, "top": 0.3}
                size_hint: 0.25, 0.25
                on_release: root.revert_mac()

            Button:
                text: "Back"
                pos_hint: {"center_x": 0.2, "top": 0.3}
                size_hint: 0.25, 0.25
                on_release:
                    app.root.current = "penetration_tools_screen"
                    root.manager.transition.direction = "right"


<SpoofARPScreen>:
    name: "spoof_arp_screen"

    BoxLayout:
        orientation: "vertical"

        Label:
            text: "Test"

        Button:
            text: "Back"
            pos_hint: {"center_x": 0.5}
            size_hint_x: 0.5
            on_release:
                app.root.current = "penetration_tools_screen"
                root.manager.transition.direction = "right"